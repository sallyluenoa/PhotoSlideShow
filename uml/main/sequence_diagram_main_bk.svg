<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1783px" preserveAspectRatio="none" style="width:2011px;height:1783px;" version="1.1" viewBox="0 0 2011 1783" width="2011px" zoomAndPan="magnify"><defs><filter height="300%" id="fn81zmrqlnskj" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFEE" height="1768.8359" style="stroke: #A80036; stroke-width: 1.0;" width="895.5" x="29" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="454.75" y="16.0669">VIPER</text><rect fill="#EEFFFF" height="1768.8359" style="stroke: #A80036; stroke-width: 1.0;" width="306" x="926.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1048.5" y="16.0669">Web API</text><rect fill="#FFEEFF" height="1768.8359" style="stroke: #A80036; stroke-width: 1.0;" width="601" x="1234.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="1499" y="16.0669">Database</text><rect fill="#E6FFE9" height="1768.8359" style="stroke: #A80036; stroke-width: 1.0;" width="161" x="1837.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="1905" y="16.0669">File</text><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="51.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="54" y="68.4297"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="1626.9766" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="326" y="89.5625"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="342.4922"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="791.2188"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="1321.2109"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="118.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="148.6953"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="118.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="456.7578"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="262.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="628.5547"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="118.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="970.75"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="1238.9453"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="216.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="1442.4766"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="998.5" y="657.6875"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1152.5" y="1471.6094"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1306" y="201.9609"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1306" y="510.0234"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1486.5" y="1024.0156"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1913" y="1572.0078"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="791" x="602.5" y="163.6953"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="368" x="23" y="282.2266"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="791" x="602.5" y="471.7578"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="309.1953" style="stroke: #000000; stroke-width: 2.0;" width="1380.5" x="13" y="590.2891"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="132.3984" style="stroke: #000000; stroke-width: 2.0;" width="690.5" x="23" y="701.8203"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="997" x="602.5" y="985.75"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="266.9297" style="stroke: #000000; stroke-width: 2.0;" width="1596.5" x="13" y="1104.2813"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="163.5313" style="stroke: #000000; stroke-width: 2.0;" width="1576.5" x="23" y="1200.6797"/><rect fill="#FFFFFF" height="88.1328" style="stroke: none; stroke-width: 1.0;" width="1576.5" x="23" y="1276.0781"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="59" x2="59" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="330.5" x2="330.5" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="657.5" x2="657.5" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="886.5" x2="886.5" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1003.5" x2="1003.5" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1157.5" x2="1157.5" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1310.5" x2="1310.5" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1491.5" x2="1491.5" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1715.5" x2="1715.5" y1="58.4297" y2="1734.5391"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1917.5" x2="1917.5" y1="58.4297" y2="1734.5391"/><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="33" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="40" y="43.1279">View</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="33" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="40" y="1753.5342">View</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="286.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="293.5" y="43.1279">Presenter</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="286.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="293.5" y="1753.5342">Presenter</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="612.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="619.5" y="43.1279">Interactor</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="612.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="619.5" y="1753.5342">Interactor</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="853.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="860.5" y="43.1279">Router</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="853.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="860.5" y="1753.5342">Router</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="930.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="937.5" y="43.1279">GoogleOAuth2Api</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="930.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="937.5" y="1753.5342">GoogleOAuth2Api</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1086.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1093.5" y="43.1279">PhotosLibraryApi</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1086.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1093.5" y="1753.5342">PhotosLibraryApi</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="1238.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="1245.5" y="43.1279">UserInfoDatabase</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="1238.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="1245.5" y="1753.5342">UserInfoDatabase</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="192" x="1393.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="178" x="1400.5" y="43.1279">SelectedAlbumDatabase</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="192" x="1393.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="178" x="1400.5" y="1753.5342">SelectedAlbumDatabase</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="228" x="1599.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="214" x="1606.5" y="43.1279">DisplayedMediaItemDatabase</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="228" x="1599.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="214" x="1606.5" y="1753.5342">DisplayedMediaItemDatabase</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1841.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1848.5" y="43.1279">PhotosDownloader</text><rect fill="#FEFECE" filter="url(#fn81zmrqlnskj)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1841.5" y="1733.5391"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1848.5" y="1753.5342">PhotosDownloader</text><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="51.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="54" y="68.4297"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="1626.9766" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="326" y="89.5625"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="342.4922"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="791.2188"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="1321.2109"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="118.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="148.6953"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="118.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="456.7578"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="262.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="628.5547"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="118.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="970.75"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="1238.9453"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="216.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="653" y="1442.4766"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="998.5" y="657.6875"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1152.5" y="1471.6094"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1306" y="201.9609"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1306" y="510.0234"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1486.5" y="1024.0156"/><rect fill="#FFFFFF" filter="url(#fn81zmrqlnskj)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1913" y="1572.0078"/><polygon fill="#A80036" points="314,85.5625,324,89.5625,314,93.5625,318,89.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="320" y1="89.5625" y2="89.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="71" y="84.4966">requestUpdatePhotos</text><polygon fill="#A80036" points="641,144.6953,651,148.6953,641,152.6953,645,148.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="647" y1="148.6953" y2="148.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="343" y="143.6294">isNeededUpdatePhotos</text><path d="M602.5,163.6953 L674.5,163.6953 L674.5,170.6953 L664.5,180.6953 L602.5,180.6953 L602.5,163.6953 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="791" x="602.5" y="163.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="617.5" y="176.7622">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="689.5" y="175.9058">[this.userInfo==null]</text><polygon fill="#A80036" points="1294,197.9609,1304,201.9609,1294,205.9609,1298,201.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="1300" y1="201.9609" y2="201.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="670" y="196.895">find</text><polygon fill="#A80036" points="674,227.0938,664,231.0938,674,235.0938,670,231.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="668" x2="1310" y1="231.0938" y2="231.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="680" y="226.0278">UserInfo</text><polygon fill="#A80036" points="347,263.2266,337,267.2266,347,271.2266,343,267.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="657" y1="267.2266" y2="267.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="253" x="353" y="262.1606">Callback#isNeededUpdatePhotosResult</text><path d="M23,282.2266 L95,282.2266 L95,289.2266 L85,299.2266 L23,299.2266 L23,282.2266 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="368" x="23" y="282.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="38" y="295.2935">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="215" x="110" y="294.437">[!isNeededPhotosUpdateResult]</text><polygon fill="#A80036" points="70,316.4922,60,320.4922,70,324.4922,66,320.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="325" y1="320.4922" y2="320.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="315.4263">Callback#requestUpdatePhotosResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="383" y1="329.4922" y2="329.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="383" x2="383" y1="329.4922" y2="342.4922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="383" y1="342.4922" y2="342.4922"/><polygon fill="#A80036" points="352,338.4922,342,342.4922,352,346.4922,348,342.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="368.4922" y2="386.4922"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="386.4922" y2="368.4922"/><rect fill="#EEEEEE" filter="url(#fn81zmrqlnskj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1996.5" x="3" y="413.0586"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1999.5" y1="413.0586" y2="413.0586"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1999.5" y1="416.0586" y2="416.0586"/><rect fill="#EEEEEE" filter="url(#fn81zmrqlnskj)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="177" x="912.75" y="402.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="918.75" y="418.5591">Update AccessToken</text><polygon fill="#A80036" points="641,452.7578,651,456.7578,641,460.7578,645,456.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="647" y1="456.7578" y2="456.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="343" y="451.6919">isNeededUpdateAccessToken</text><path d="M602.5,471.7578 L674.5,471.7578 L674.5,478.7578 L664.5,488.7578 L602.5,488.7578 L602.5,471.7578 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="791" x="602.5" y="471.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="617.5" y="484.8247">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="689.5" y="483.9683">[this.userInfo==null]</text><polygon fill="#A80036" points="1294,506.0234,1304,510.0234,1294,514.0234,1298,510.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="1300" y1="510.0234" y2="510.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="670" y="504.9575">find</text><polygon fill="#A80036" points="674,535.1563,664,539.1563,674,543.1563,670,539.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="668" x2="1310" y1="539.1563" y2="539.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="680" y="534.0903">UserInfo</text><polygon fill="#A80036" points="347,571.2891,337,575.2891,347,579.2891,343,575.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="657" y1="575.2891" y2="575.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="293" x="353" y="570.2231">Callback#isNeededUpdateAccessTokenResult</text><path d="M13,590.2891 L85,590.2891 L85,597.2891 L75,607.2891 L13,607.2891 L13,590.2891 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="309.1953" style="stroke: #000000; stroke-width: 2.0;" width="1380.5" x="13" y="590.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="28" y="603.356">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="252" x="100" y="602.4995">[!isNeededUpdateAccessTokenResult]</text><polygon fill="#A80036" points="641,624.5547,651,628.5547,641,632.5547,645,628.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="647" y1="628.5547" y2="628.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="343" y="623.4888">requestUpdateAccessToken</text><polygon fill="#A80036" points="986.5,653.6875,996.5,657.6875,986.5,661.6875,990.5,657.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="992.5" y1="657.6875" y2="657.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="670" y="652.6216">requestTokenInfoWithRefreshToken</text><polygon fill="#A80036" points="674,682.8203,664,686.8203,674,690.8203,670,686.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="668" x2="1002.5" y1="686.8203" y2="686.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="680" y="681.7544">TokenInfo</text><path d="M23,701.8203 L95,701.8203 L95,708.8203 L85,718.8203 L23,718.8203 L23,701.8203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="132.3984" style="stroke: #000000; stroke-width: 2.0;" width="690.5" x="23" y="701.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="38" y="714.8872">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="110" y="714.0308">[TokenInfo==null]</text><polygon fill="#A80036" points="347,736.0859,337,740.0859,347,744.0859,343,740.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="652" y1="740.0859" y2="740.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="353" y="735.02">Callback#requestUpdateAccessTokenResult</text><polygon fill="#A80036" points="70,765.2188,60,769.2188,70,773.2188,66,769.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="325" y1="769.2188" y2="769.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="764.1528">Callback#requestUpdatePhotosResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="383" y1="778.2188" y2="778.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="383" x2="383" y1="778.2188" y2="791.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="383" y1="791.2188" y2="791.2188"/><polygon fill="#A80036" points="352,787.2188,342,791.2188,352,795.2188,348,791.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="817.2188" y2="835.2188"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="835.2188" y2="817.2188"/><polygon fill="#A80036" points="1299,858.3516,1309,862.3516,1299,866.3516,1303,862.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="1305" y1="862.3516" y2="862.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="670" y="857.2856">update</text><polygon fill="#A80036" points="347,887.4844,337,891.4844,347,895.4844,343,891.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="657" y1="891.4844" y2="891.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="353" y="886.4185">Callback#requestUpdateAccessTokenResult</text><rect fill="#EEEEEE" filter="url(#fn81zmrqlnskj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1996.5" x="3" y="927.0508"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1999.5" y1="927.0508" y2="927.0508"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1999.5" y1="930.0508" y2="930.0508"/><rect fill="#EEEEEE" filter="url(#fn81zmrqlnskj)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="190" x="906.25" y="916.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="912.25" y="932.5513">Decide Selected Album</text><polygon fill="#A80036" points="641,966.75,651,970.75,641,974.75,645,970.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="647" y1="970.75" y2="970.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="343" y="965.6841">hasSelectedAlbum</text><path d="M602.5,985.75 L674.5,985.75 L674.5,992.75 L664.5,1002.75 L602.5,1002.75 L602.5,985.75 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="997" x="602.5" y="985.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="617.5" y="998.8169">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="689.5" y="997.9604">[this.selectedAlbum==null]</text><polygon fill="#A80036" points="1474.5,1020.0156,1484.5,1024.0156,1474.5,1028.0156,1478.5,1024.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="1480.5" y1="1024.0156" y2="1024.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="670" y="1018.9497">find</text><polygon fill="#A80036" points="674,1049.1484,664,1053.1484,674,1057.1484,670,1053.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="668" x2="1490.5" y1="1053.1484" y2="1053.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="680" y="1048.0825">SelectedAlbum</text><polygon fill="#A80036" points="347,1085.2813,337,1089.2813,347,1093.2813,343,1089.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="657" y1="1089.2813" y2="1089.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="223" x="353" y="1084.2153">Callback#hasSelectedAlbumResult</text><path d="M13,1104.2813 L85,1104.2813 L85,1111.2813 L75,1121.2813 L13,1121.2813 L13,1104.2813 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="266.9297" style="stroke: #000000; stroke-width: 2.0;" width="1596.5" x="13" y="1104.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="28" y="1117.3481">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="100" y="1116.4917">[!hasSelectedAlbumResult]</text><polygon fill="#A80036" points="875,1138.5469,885,1142.5469,875,1146.5469,879,1142.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="881" y1="1142.5469" y2="1142.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="343" y="1137.481">startSelectActivity</text><polygon fill="#A80036" points="47,1152.5469,57,1156.5469,47,1160.5469,51,1156.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="3" x2="53" y1="1156.5469" y2="1156.5469"/><polygon fill="#A80036" points="314,1181.6797,324,1185.6797,314,1189.6797,318,1185.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="59" x2="320" y1="1185.6797" y2="1185.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="66" y="1180.6138">evaluateActivityResult</text><path d="M23,1200.6797 L89,1200.6797 L89,1207.6797 L79,1217.6797 L23,1217.6797 L23,1200.6797 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="163.5313" style="stroke: #000000; stroke-width: 2.0;" width="1576.5" x="23" y="1200.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="38" y="1213.7466">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="104" y="1212.8901">[Has selected album?]</text><polygon fill="#A80036" points="641,1234.9453,651,1238.9453,641,1242.9453,645,1238.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="647" y1="1238.9453" y2="1238.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="343" y="1233.8794">requestUpdateSelectedAlbum</text><polygon fill="#A80036" points="1479.5,1264.0781,1489.5,1268.0781,1479.5,1272.0781,1483.5,1268.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="658" x2="1485.5" y1="1268.0781" y2="1268.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="665" y="1263.0122">update</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1599.5" y1="1277.0781" y2="1277.0781"/><polygon fill="#A80036" points="70,1295.2109,60,1299.2109,70,1303.2109,66,1299.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="325" y1="1299.2109" y2="1299.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="1294.145">Callback#requestUpdatePhotosResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="383" y1="1308.2109" y2="1308.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="383" x2="383" y1="1308.2109" y2="1321.2109"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="383" y1="1321.2109" y2="1321.2109"/><polygon fill="#A80036" points="352,1317.2109,342,1321.2109,352,1325.2109,348,1321.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="1347.2109" y2="1365.2109"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="1365.2109" y2="1347.2109"/><rect fill="#EEEEEE" filter="url(#fn81zmrqlnskj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1996.5" x="3" y="1398.7773"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1999.5" y1="1398.7773" y2="1398.7773"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1999.5" y1="1401.7773" y2="1401.7773"/><rect fill="#EEEEEE" filter="url(#fn81zmrqlnskj)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="152" x="925.25" y="1388.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="931.25" y="1404.2778">Download Images</text><polygon fill="#A80036" points="641,1438.4766,651,1442.4766,641,1446.4766,645,1442.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="647" y1="1442.4766" y2="1442.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="343" y="1437.4106">requestDownloadMediaItems</text><polygon fill="#A80036" points="1140.5,1467.6094,1150.5,1471.6094,1140.5,1475.6094,1144.5,1471.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="1146.5" y1="1471.6094" y2="1471.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="670" y="1466.5435">requestMediaItems</text><polygon fill="#A80036" points="674,1496.7422,664,1500.7422,674,1504.7422,670,1500.7422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="668" x2="1156.5" y1="1500.7422" y2="1500.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="680" y="1495.6763">List&lt;MediaItem&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="705" y1="1529.875" y2="1529.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="1529.875" y2="1542.875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="664" x2="705" y1="1542.875" y2="1542.875"/><polygon fill="#A80036" points="674,1538.875,664,1542.875,674,1546.875,670,1542.875" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="670" y="1524.8091">Make random photo MediaItems</text><polygon fill="#A80036" points="1901,1568.0078,1911,1572.0078,1901,1576.0078,1905,1572.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="1907" y1="1572.0078" y2="1572.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="670" y="1566.9419">requestDownloads</text><polygon fill="#A80036" points="674,1597.1406,664,1601.1406,674,1605.1406,670,1601.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="668" x2="1917" y1="1601.1406" y2="1601.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="680" y="1596.0747">List&lt;String&gt;</text><polygon fill="#A80036" points="1703.5,1626.2734,1713.5,1630.2734,1703.5,1634.2734,1707.5,1630.2734" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="1709.5" y1="1630.2734" y2="1630.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="670" y="1625.2075">replace</text><polygon fill="#A80036" points="347,1655.4063,337,1659.4063,347,1663.4063,343,1659.4063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="657" y1="1659.4063" y2="1659.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="290" x="353" y="1654.3403">Callback#requestDownloadMediaItemsResult</text><rect fill="#EEEEEE" filter="url(#fn81zmrqlnskj)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1996.5" x="3" y="1680.4063"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1999.5" y1="1680.4063" y2="1680.4063"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1999.5" y1="1683.4063" y2="1683.4063"/><polygon fill="#A80036" points="70,1712.5391,60,1716.5391,70,1720.5391,66,1716.5391" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="330" y1="1716.5391" y2="1716.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="1711.4731">Callback#requestUpdatePhotosResult</text><!--MD5=[9e6992b57ae2277a347e5b0f8ac4cba4]
@startuml
box "VIPER" #FFFFEE
  participant View
  participant Presenter
  participant Interactor
  participant Router
end box

box "Web API" #EEFFFF
  participant GoogleOAuth2Api
  participant PhotosLibraryApi
end box

box "Database" #FFEEFF
  participant UserInfoDatabase
  participant SelectedAlbumDatabase
  participant DisplayedMediaItemDatabase
end box

box "File" #E6FFE9
  participant PhotosDownloader
end box


View++
View -> Presenter++: requestUpdatePhotos
View- -

Presenter -> Interactor++: isNeededUpdatePhotos
  opt this.userInfo==null
    Interactor -> UserInfoDatabase++: find
    return UserInfo
  end
return Callback#isNeededUpdatePhotosResult

opt !isNeededPhotosUpdateResult
  View <- - Presenter: Callback#requestUpdatePhotosResult
  Presenter -> Presenter++
  destroy Presenter
end

== Update AccessToken ==

Presenter -> Interactor++: isNeededUpdateAccessToken
  opt this.userInfo==null
    Interactor -> UserInfoDatabase++: find
    return UserInfo
  end
return Callback#isNeededUpdateAccessTokenResult

opt !isNeededUpdateAccessTokenResult
  Presenter -> Interactor++: requestUpdateAccessToken
  Interactor -> GoogleOAuth2Api++: requestTokenInfoWithRefreshToken
  return TokenInfo

  opt TokenInfo==null
    Presenter <- - Interactor: Callback#requestUpdateAccessTokenResult
    View <- - Presenter: Callback#requestUpdatePhotosResult
    Presenter -> Presenter++
    destroy Presenter
  end

  Interactor -> UserInfoDatabase: update
  Presenter <- - Interactor- -: Callback#requestUpdateAccessTokenResult
end

== Decide Selected Album ==

Presenter -> Interactor++: hasSelectedAlbum
  opt this.selectedAlbum==null
    Interactor -> SelectedAlbumDatabase++: find
    return SelectedAlbum
  end
return Callback#hasSelectedAlbumResult

opt !hasSelectedAlbumResult
  Presenter -> Router: startSelectActivity
  [- -> View
  View - -> Presenter: evaluateActivityResult

  alt Has selected album?
    Presenter -> Interactor++: requestUpdateSelectedAlbum
    Interactor -> SelectedAlbumDatabase: update
    Interactor- -
  else
    View <- - Presenter: Callback#requestUpdatePhotosResult
    Presenter -> Presenter++
    destroy Presenter
  end
end

== Download Images ==

Presenter -> Interactor++: requestDownloadMediaItems

  Interactor -> PhotosLibraryApi++: requestMediaItems
  return List<MediaItem>

  Interactor -> Interactor: Make random photo MediaItems

  Interactor -> PhotosDownloader++: requestDownloads
  return List<String>

  Interactor -> DisplayedMediaItemDatabase: replace

Presenter <- - Interactor- -: Callback#requestDownloadMediaItemsResult

====

View <- - Presenter- -: Callback#requestUpdatePhotosResult
@enduml

PlantUML version 1.2020.15beta1(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>