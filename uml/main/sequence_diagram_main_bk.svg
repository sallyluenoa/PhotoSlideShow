<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1675px" preserveAspectRatio="none" style="width:1395px;height:1675px;" version="1.1" viewBox="0 0 1395 1675" width="1395px" zoomAndPan="magnify"><defs><filter height="300%" id="f1i1yfqv559o49" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFEE" height="1660.4375" style="stroke: #A80036; stroke-width: 1.0;" width="897.5" x="29" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="455.75" y="16.0669">VIPER</text><rect fill="#FFEEFF" height="1660.4375" style="stroke: #A80036; stroke-width: 1.0;" width="124" x="928.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="954.5" y="16.0669">Database</text><rect fill="#E6FFE9" height="1660.4375" style="stroke: #A80036; stroke-width: 1.0;" width="161" x="1054.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="1122" y="16.0669">File</text><rect fill="#EEFFFF" height="1660.4375" style="stroke: #A80036; stroke-width: 1.0;" width="150" x="1217.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1261.5" y="16.0669">Web API</text><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="472.8594" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="54" y="68.4297"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="392.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="326" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="1096.8516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="326" y="511.2891"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="674.8203"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="1181.6797"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="334.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="118.6953"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="570.4219"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="789.0859"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="158.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="969.8828"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="248.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="1302.9453"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="985.5" y="171.9609"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="985.5" y="338.625"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="985.5" y="1028.1484"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1130" y="1463.6094"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1287.5" y="1356.2109"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="291.1953" style="stroke: #000000; stroke-width: 2.0;" width="474" x="594.5" y="133.6953"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="117.5313" style="stroke: #000000; stroke-width: 2.0;" width="454" x="604.5" y="300.3594"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="368" x="23" y="614.5547"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="398.4609" style="stroke: #000000; stroke-width: 2.0;" width="1055.5" x="13" y="833.2188"/><rect fill="#FFFFFF" height="381.3281" style="stroke: none; stroke-width: 1.0;" width="1055.5" x="13" y="850.3516"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="293.0625" style="stroke: #000000; stroke-width: 2.0;" width="1035.5" x="23" y="931.6172"/><rect fill="#FFFFFF" height="88.1328" style="stroke: none; stroke-width: 1.0;" width="1035.5" x="23" y="1136.5469"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="117.5313" style="stroke: #000000; stroke-width: 2.0;" width="769" x="604.5" y="1317.9453"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="59" x2="59" y1="58.4297" y2="1626.1406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="330.5" x2="330.5" y1="58.4297" y2="1626.1406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="659.5" x2="659.5" y1="58.4297" y2="1626.1406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="888.5" x2="888.5" y1="58.4297" y2="1626.1406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="990.5" x2="990.5" y1="58.4297" y2="1626.1406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1134.5" x2="1134.5" y1="58.4297" y2="1626.1406"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1292.5" x2="1292.5" y1="58.4297" y2="1626.1406"/><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="33" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="40" y="43.1279">View</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="33" y="1625.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="40" y="1645.1357">View</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="286.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="293.5" y="43.1279">Presenter</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="286.5" y="1625.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="293.5" y="1645.1357">Presenter</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="614.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="621.5" y="43.1279">Interactor</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="614.5" y="1625.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="621.5" y="1645.1357">Interactor</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="855.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="862.5" y="43.1279">Router</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="855.5" y="1625.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="862.5" y="1645.1357">Router</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="932.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="939.5" y="43.1279">AppDatabase</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="932.5" y="1625.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="939.5" y="1645.1357">AppDatabase</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1058.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1065.5" y="43.1279">PhotosDownloader</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1058.5" y="1625.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1065.5" y="1645.1357">PhotosDownloader</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1221.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1228.5" y="43.1279">PhotosLibraryApi</text><rect fill="#FEFECE" filter="url(#f1i1yfqv559o49)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1221.5" y="1625.1406"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1228.5" y="1645.1357">PhotosLibraryApi</text><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="472.8594" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="54" y="68.4297"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="392.5938" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="326" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="1096.8516" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="326" y="511.2891"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="674.8203"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="331" y="1181.6797"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="334.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="118.6953"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="570.4219"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="789.0859"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="158.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="969.8828"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="248.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="655" y="1302.9453"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="985.5" y="171.9609"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="985.5" y="338.625"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="985.5" y="1028.1484"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1130" y="1463.6094"/><rect fill="#FFFFFF" filter="url(#f1i1yfqv559o49)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1287.5" y="1356.2109"/><polygon fill="#A80036" points="314,85.5625,324,89.5625,314,93.5625,318,89.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="320" y1="89.5625" y2="89.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="71" y="84.4966">requestLoadDisplayedPhotos</text><polygon fill="#A80036" points="643,114.6953,653,118.6953,643,122.6953,647,118.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="649" y1="118.6953" y2="118.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="343" y="113.6294">requestLoadDisplayedPhotos</text><path d="M594.5,133.6953 L666.5,133.6953 L666.5,140.6953 L656.5,150.6953 L594.5,150.6953 L594.5,133.6953 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="291.1953" style="stroke: #000000; stroke-width: 2.0;" width="474" x="594.5" y="133.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="609.5" y="146.7622">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="681.5" y="145.9058">[this.userInfo.id == 0]</text><polygon fill="#A80036" points="973.5,167.9609,983.5,171.9609,973.5,175.9609,977.5,171.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="979.5" y1="171.9609" y2="171.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="672" y="166.895">findUserInfoWithSelectedAlbums</text><polygon fill="#A80036" points="676,197.0938,666,201.0938,676,205.0938,672,201.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="670" x2="989.5" y1="201.0938" y2="201.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="682" y="196.0278">UserInfoWithSelectedAlbums?</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="707" y1="230.2266" y2="230.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="707" x2="707" y1="230.2266" y2="243.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="707" y1="243.2266" y2="243.2266"/><polygon fill="#A80036" points="676,239.2266,666,243.2266,676,247.2266,672,243.2266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="672" y="225.1606">Update this.userInfo</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="707" y1="272.3594" y2="272.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="707" x2="707" y1="272.3594" y2="285.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="707" y1="285.3594" y2="285.3594"/><polygon fill="#A80036" points="676,281.3594,666,285.3594,676,289.3594,672,285.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="672" y="267.2935">Update this.selectedAlbums</text><path d="M604.5,300.3594 L682.5,300.3594 L682.5,307.3594 L672.5,317.3594 L604.5,317.3594 L604.5,300.3594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="117.5313" style="stroke: #000000; stroke-width: 2.0;" width="454" x="604.5" y="300.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="619.5" y="313.4263">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="172" x="697.5" y="312.5698">[selectedAlbums.foreach]</text><polygon fill="#A80036" points="973.5,334.625,983.5,338.625,973.5,342.625,977.5,338.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="979.5" y1="338.625" y2="338.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="256" x="672" y="333.5591">findSelectedAlbumWithDisplayedPhotos</text><polygon fill="#A80036" points="676,363.7578,666,367.7578,676,371.7578,672,367.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="670" x2="989.5" y1="367.7578" y2="367.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="682" y="362.6919">SelectedAlbumWithDisplayedPhotos?</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="707" y1="396.8906" y2="396.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="707" x2="707" y1="396.8906" y2="409.8906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="707" y1="409.8906" y2="409.8906"/><polygon fill="#A80036" points="676,405.8906,666,409.8906,676,413.8906,672,409.8906" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="672" y="391.8247">Update this.displayedPhotos</text><polygon fill="#A80036" points="347,449.0234,337,453.0234,347,457.0234,343,453.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="659" y1="453.0234" y2="453.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="353" y="447.9575">List&lt;DisplayedPhoto&gt;</text><polygon fill="#A80036" points="75,478.1563,65,482.1563,75,486.1563,71,482.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="69" x2="330" y1="482.1563" y2="482.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="81" y="477.0903">List&lt;DisplayedPhoto&gt;</text><polygon fill="#A80036" points="314,507.2891,324,511.2891,314,515.2891,318,511.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="320" y1="511.2891" y2="511.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="71" y="506.2231">requestUpdateDisplayedPhotos</text><polygon fill="#A80036" points="643,566.4219,653,570.4219,643,574.4219,647,570.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="649" y1="570.4219" y2="570.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="343" y="565.356">isNeededUpdatePhotos</text><polygon fill="#A80036" points="347,595.5547,337,599.5547,347,603.5547,343,599.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="659" y1="599.5547" y2="599.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="353" y="594.4888">Boolean</text><path d="M23,614.5547 L95,614.5547 L95,621.5547 L85,631.5547 L23,631.5547 L23,614.5547 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="368" x="23" y="614.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="38" y="627.6216">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="110" y="626.7651">[!isNeededUpdatePhotos]</text><polygon fill="#A80036" points="70,648.8203,60,652.8203,70,656.8203,66,652.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="325" y1="652.8203" y2="652.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="647.7544">Callback#requestUpdatePhotosResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="383" y1="661.8203" y2="661.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="383" x2="383" y1="661.8203" y2="674.8203"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="383" y1="674.8203" y2="674.8203"/><polygon fill="#A80036" points="352,670.8203,342,674.8203,352,678.8203,348,674.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="700.8203" y2="718.8203"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="718.8203" y2="700.8203"/><rect fill="#EEEEEE" filter="url(#f1i1yfqv559o49)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1380.5" x="3" y="745.3867"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1383.5" y1="745.3867" y2="745.3867"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1383.5" y1="748.3867" y2="748.3867"/><rect fill="#EEEEEE" filter="url(#f1i1yfqv559o49)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="190" x="598.25" y="734.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="604.25" y="750.8872">Decide Selected Album</text><polygon fill="#A80036" points="643,785.0859,653,789.0859,643,793.0859,647,789.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="649" y1="789.0859" y2="789.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="343" y="784.02">hasSelectedAlbums</text><polygon fill="#A80036" points="347,814.2188,337,818.2188,347,822.2188,343,818.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="659" y1="818.2188" y2="818.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="353" y="813.1528">Boolean</text><path d="M13,833.2188 L79,833.2188 L79,840.2188 L69,850.2188 L13,850.2188 L13,833.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="398.4609" style="stroke: #000000; stroke-width: 2.0;" width="1055.5" x="13" y="833.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="28" y="846.2856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="139" x="94" y="845.4292">[hasSelectedAlbums]</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="13" x2="1068.5" y1="851.3516" y2="851.3516"/><polygon fill="#A80036" points="877,869.4844,887,873.4844,877,877.4844,881,873.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="883" y1="873.4844" y2="873.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="343" y="868.4185">startSelectActivity</text><polygon fill="#A80036" points="47,883.4844,57,887.4844,47,891.4844,51,887.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="3" x2="53" y1="887.4844" y2="887.4844"/><polygon fill="#A80036" points="314,912.6172,324,916.6172,314,920.6172,318,916.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="59" x2="320" y1="916.6172" y2="916.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="66" y="911.5513">evaluateActivityResult</text><path d="M23,931.6172 L89,931.6172 L89,938.6172 L79,948.6172 L23,948.6172 L23,931.6172 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="293.0625" style="stroke: #000000; stroke-width: 2.0;" width="1035.5" x="23" y="931.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="38" y="944.6841">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="104" y="943.8276">[Has selected album?]</text><polygon fill="#A80036" points="643,965.8828,653,969.8828,643,973.8828,647,969.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="649" y1="969.8828" y2="969.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="191" x="343" y="964.8169">requestUpdateSelectedAlbum</text><polygon fill="#A80036" points="978.5,995.0156,988.5,999.0156,978.5,1003.0156,982.5,999.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="984.5" y1="999.0156" y2="999.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="148" x="672" y="993.9497">updateSelectedAlbums</text><polygon fill="#A80036" points="973.5,1024.1484,983.5,1028.1484,973.5,1032.1484,977.5,1028.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="979.5" y1="1028.1484" y2="1028.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="672" y="1023.0825">findUserInfoWithSelectedAlbums</text><polygon fill="#A80036" points="676,1053.2813,666,1057.2813,676,1061.2813,672,1057.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="670" x2="989.5" y1="1057.2813" y2="1057.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="682" y="1052.2153">UserInfoWithSelectedAlbums?</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="707" y1="1086.4141" y2="1086.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="707" x2="707" y1="1086.4141" y2="1099.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="707" y1="1099.4141" y2="1099.4141"/><polygon fill="#A80036" points="676,1095.4141,666,1099.4141,676,1103.4141,672,1099.4141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="672" y="1081.3481">Update this.selectedAlbums</text><polygon fill="#A80036" points="347,1124.5469,337,1128.5469,347,1132.5469,343,1128.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="659" y1="1128.5469" y2="1128.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="295" x="353" y="1123.481">Callback#requestUpdateSelectedAlbumResult</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="23" x2="1058.5" y1="1137.5469" y2="1137.5469"/><polygon fill="#A80036" points="70,1155.6797,60,1159.6797,70,1163.6797,66,1159.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="325" y1="1159.6797" y2="1159.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="1154.6138">Callback#requestUpdatePhotosResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="383" y1="1168.6797" y2="1168.6797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="383" x2="383" y1="1168.6797" y2="1181.6797"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="342" x2="383" y1="1181.6797" y2="1181.6797"/><polygon fill="#A80036" points="352,1177.6797,342,1181.6797,352,1185.6797,348,1181.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="1207.6797" y2="1225.6797"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="322" x2="340" y1="1225.6797" y2="1207.6797"/><rect fill="#EEEEEE" filter="url(#f1i1yfqv559o49)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1380.5" x="3" y="1259.2461"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1383.5" y1="1259.2461" y2="1259.2461"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1383.5" y1="1262.2461" y2="1262.2461"/><rect fill="#EEEEEE" filter="url(#f1i1yfqv559o49)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="152" x="617.25" y="1248.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="623.25" y="1264.7466">Download Images</text><polygon fill="#A80036" points="643,1298.9453,653,1302.9453,643,1306.9453,647,1302.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="336" x2="649" y1="1302.9453" y2="1302.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="343" y="1297.8794">requestDownloadPhotos</text><path d="M604.5,1317.9453 L682.5,1317.9453 L682.5,1324.9453 L672.5,1334.9453 L604.5,1334.9453 L604.5,1317.9453 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="117.5313" style="stroke: #000000; stroke-width: 2.0;" width="769" x="604.5" y="1317.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="619.5" y="1331.0122">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="202" x="697.5" y="1330.1558">[this.selectedAlbums.foreach]</text><polygon fill="#A80036" points="1275.5,1352.2109,1285.5,1356.2109,1275.5,1360.2109,1279.5,1356.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="1281.5" y1="1356.2109" y2="1356.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="672" y="1351.145">requestMediaItems</text><polygon fill="#A80036" points="676,1381.3438,666,1385.3438,676,1389.3438,672,1385.3438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="670" x2="1291.5" y1="1385.3438" y2="1385.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="682" y="1380.2778">List&lt;MediaItem&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="707" y1="1414.4766" y2="1414.4766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="707" x2="707" y1="1414.4766" y2="1427.4766"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="666" x2="707" y1="1427.4766" y2="1427.4766"/><polygon fill="#A80036" points="676,1423.4766,666,1427.4766,676,1431.4766,672,1427.4766" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="672" y="1409.4106">Make random photo MediaItems</text><polygon fill="#A80036" points="1118,1459.6094,1128,1463.6094,1118,1467.6094,1122,1463.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="1124" y1="1463.6094" y2="1463.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="672" y="1458.5435">requestDownloads</text><polygon fill="#A80036" points="676,1488.7422,666,1492.7422,676,1496.7422,672,1492.7422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="670" x2="1134" y1="1492.7422" y2="1492.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="682" y="1487.6763">List&lt;String&gt;</text><polygon fill="#A80036" points="978.5,1517.875,988.5,1521.875,978.5,1525.875,982.5,1521.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="665" x2="984.5" y1="1521.875" y2="1521.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="672" y="1516.8091">replace</text><polygon fill="#A80036" points="347,1547.0078,337,1551.0078,347,1555.0078,343,1551.0078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="341" x2="659" y1="1551.0078" y2="1551.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="290" x="353" y="1545.9419">Callback#requestDownloadMediaItemsResult</text><rect fill="#EEEEEE" filter="url(#f1i1yfqv559o49)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1380.5" x="3" y="1572.0078"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1383.5" y1="1572.0078" y2="1572.0078"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1383.5" y1="1575.0078" y2="1575.0078"/><polygon fill="#A80036" points="70,1604.1406,60,1608.1406,70,1612.1406,66,1608.1406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="330" y1="1608.1406" y2="1608.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="1603.0747">Callback#requestUpdatePhotosResult</text><!--MD5=[93e3e38bb2b4a793330dd1df2ea11e54]
@startuml
box "VIPER" #FFFFEE
  participant View
  participant Presenter
  participant Interactor
  participant Router
end box

box "Database" #FFEEFF
  participant AppDatabase
end box

box "File" #E6FFE9
  participant PhotosDownloader
end box

box "Web API" #EEFFFF
  participant PhotosLibraryApi
end box

View++
View -> Presenter++: requestLoadDisplayedPhotos
  Presenter -> Interactor++: requestLoadDisplayedPhotos

  opt this.userInfo.id == 0
    Interactor -> AppDatabase++: findUserInfoWithSelectedAlbums
    return UserInfoWithSelectedAlbums?
    Interactor -> Interactor: Update this.userInfo
    Interactor -> Interactor: Update this.selectedAlbums

    loop selectedAlbums.foreach
      Interactor -> AppDatabase++: findSelectedAlbumWithDisplayedPhotos
      return SelectedAlbumWithDisplayedPhotos?
      Interactor -> Interactor: Update this.displayedPhotos
    end
  end

  return List<DisplayedPhoto>
return List<DisplayedPhoto>

View -> Presenter++: requestUpdateDisplayedPhotos
View- -

Presenter -> Interactor++: isNeededUpdatePhotos
return Boolean

opt !isNeededUpdatePhotos
  View <- - Presenter: Callback#requestUpdatePhotosResult
  Presenter -> Presenter++
  destroy Presenter
end

== Decide Selected Album ==

Presenter -> Interactor++: hasSelectedAlbums
return Boolean

alt hasSelectedAlbums
  


else
  Presenter -> Router: startSelectActivity
  [- -> View
  View - -> Presenter: evaluateActivityResult

  alt Has selected album?
    Presenter -> Interactor++: requestUpdateSelectedAlbum
      Interactor -> AppDatabase: updateSelectedAlbums
      Interactor -> AppDatabase++: findUserInfoWithSelectedAlbums
      return UserInfoWithSelectedAlbums?
      Interactor -> Interactor: Update this.selectedAlbums
    return Callback#requestUpdateSelectedAlbumResult
  else
    View <- - Presenter: Callback#requestUpdatePhotosResult
    Presenter -> Presenter++
    destroy Presenter
  end
end

== Download Images ==

Presenter -> Interactor++: requestDownloadPhotos

  loop this.selectedAlbums.foreach
    Interactor -> PhotosLibraryApi++: requestMediaItems
    return List<MediaItem>
    Interactor -> Interactor: Make random photo MediaItems
  end

  Interactor -> PhotosDownloader++: requestDownloads
  return List<String>

  Interactor -> AppDatabase: replace

Presenter <- - Interactor- -: Callback#requestDownloadMediaItemsResult

====

View <- - Presenter- -: Callback#requestUpdatePhotosResult
@enduml

PlantUML version 1.2020.16beta7(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>