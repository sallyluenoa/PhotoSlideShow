<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1615px" preserveAspectRatio="none" style="width:1552px;height:1615px;" version="1.1" viewBox="0 0 1552 1615" width="1552px" zoomAndPan="magnify"><defs><filter height="300%" id="f5lxp6rl0pyr4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFEE" height="1600.1719" style="stroke: #A80036; stroke-width: 1.0;" width="1063.5" x="29" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="538.75" y="16.0669">VIPER</text><rect fill="#FFEEFF" height="1600.1719" style="stroke: #A80036; stroke-width: 1.0;" width="124" x="1094.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="1120.5" y="16.0669">Database</text><rect fill="#E6FFE9" height="1600.1719" style="stroke: #A80036; stroke-width: 1.0;" width="161" x="1220.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="1288" y="16.0669">File</text><rect fill="#EEFFFF" height="1600.1719" style="stroke: #A80036; stroke-width: 1.0;" width="141" x="1383.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1423" y="16.0669">Web API</text><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="299.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="54" y="68.4297"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="218.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="339" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="1210.25" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="339" y="337.625"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="344" y="544.2891"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="344" y="859.3516"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="160.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="118.6953"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="439.8906"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="658.5547"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="321.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="980.6172"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="116.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="1374.2109"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1151.5" y="171.9609"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1151.5" y="1432.4766"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1296" y="1194.5469"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1449" y="1033.8828"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="641" x="583.5" y="133.6953"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="381" x="23" y="484.0234"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="206.6641" style="stroke: #000000; stroke-width: 2.0;" width="1085.5" x="13" y="702.6875"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="381" x="23" y="799.0859"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="278.1953" style="stroke: #000000; stroke-width: 2.0;" width="957" x="573.5" y="995.6172"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="641" x="583.5" y="1078.0156"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="59" x2="59" y1="58.4297" y2="1565.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="343.5" x2="343.5" y1="58.4297" y2="1565.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="638.5" x2="638.5" y1="58.4297" y2="1565.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1054.5" x2="1054.5" y1="58.4297" y2="1565.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1156.5" x2="1156.5" y1="58.4297" y2="1565.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1300.5" x2="1300.5" y1="58.4297" y2="1565.875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1453.5" x2="1453.5" y1="58.4297" y2="1565.875"/><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="33" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="40" y="43.1279">View</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="33" y="1564.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="40" y="1584.8701">View</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="299.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="306.5" y="43.1279">Presenter</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="299.5" y="1564.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="306.5" y="1584.8701">Presenter</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="593.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="600.5" y="43.1279">Interactor</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="593.5" y="1564.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="600.5" y="1584.8701">Interactor</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="1021.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="1028.5" y="43.1279">Router</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="1021.5" y="1564.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="1028.5" y="1584.8701">Router</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="1098.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="1105.5" y="43.1279">AppDatabase</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="112" x="1098.5" y="1564.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="98" x="1105.5" y="1584.8701">AppDatabase</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1224.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1231.5" y="43.1279">PhotosDownloader</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1224.5" y="1564.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1231.5" y="1584.8701">PhotosDownloader</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="1387.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="1394.5" y="43.1279">GoogleWebApis</text><rect fill="#FEFECE" filter="url(#f5lxp6rl0pyr4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="129" x="1387.5" y="1564.875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="115" x="1394.5" y="1584.8701">GoogleWebApis</text><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="299.1953" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="54" y="68.4297"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="218.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="339" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="1210.25" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="339" y="337.625"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="344" y="544.2891"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="344" y="859.3516"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="160.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="118.6953"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="439.8906"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="658.5547"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="321.3281" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="980.6172"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="116.5313" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="634" y="1374.2109"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1151.5" y="171.9609"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1151.5" y="1432.4766"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1296" y="1194.5469"/><rect fill="#FFFFFF" filter="url(#f5lxp6rl0pyr4)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1449" y="1033.8828"/><polygon fill="#A80036" points="327,85.5625,337,89.5625,327,93.5625,331,89.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="333" y1="89.5625" y2="89.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="71" y="84.4966">requestLoadDisplayedPhotos</text><polygon fill="#A80036" points="622,114.6953,632,118.6953,622,122.6953,626,118.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="349" x2="628" y1="118.6953" y2="118.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="187" x="356" y="113.6294">requestLoadDisplayedPhotos</text><path d="M583.5,133.6953 L655.5,133.6953 L655.5,140.6953 L645.5,150.6953 L583.5,150.6953 L583.5,133.6953 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="641" x="583.5" y="133.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="598.5" y="146.7622">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="670.5" y="145.9058">[this.userInfoData.id == 0]</text><polygon fill="#A80036" points="1139.5,167.9609,1149.5,171.9609,1139.5,175.9609,1143.5,171.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="1145.5" y1="171.9609" y2="171.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="211" x="651" y="166.895">findUserInfoDataByEmailAddress</text><polygon fill="#A80036" points="655,197.0938,645,201.0938,655,205.0938,651,201.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="649" x2="1155.5" y1="201.0938" y2="201.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="661" y="196.0278">UserInfoData?</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="686" y1="237.2266" y2="237.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="686" x2="686" y1="237.2266" y2="250.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645" x2="686" y1="250.2266" y2="250.2266"/><polygon fill="#A80036" points="655,246.2266,645,250.2266,655,254.2266,651,250.2266" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="392" x="651" y="232.1606">Get DisplayedPhotos from UserInfoData.dataList and shuffle.</text><polygon fill="#A80036" points="360,275.3594,350,279.3594,360,283.3594,356,279.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="354" x2="638" y1="279.3594" y2="279.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="366" y="274.2935">Callback#requestLoadDisplayedPhotos</text><polygon fill="#A80036" points="75,304.4922,65,308.4922,75,312.4922,71,308.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="69" x2="343" y1="308.4922" y2="308.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="251" x="81" y="303.4263">Callback#requestLoadDisplayedPhotos</text><polygon fill="#A80036" points="327,333.625,337,337.625,327,341.625,331,337.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="64" x2="333" y1="337.625" y2="337.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="71" y="332.5591">requestUpdateDisplayedPhotos</text><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1537.5" x="3" y="396.1914"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="396.1914" y2="396.1914"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="399.1914" y2="399.1914"/><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="127" x="708.25" y="385.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="714.25" y="401.6919">Config Update</text><polygon fill="#A80036" points="622,435.8906,632,439.8906,622,443.8906,626,439.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="349" x2="628" y1="439.8906" y2="439.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="356" y="434.8247">isNeededUpdatePhotos</text><polygon fill="#A80036" points="360,465.0234,350,469.0234,360,473.0234,356,469.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="354" x2="638" y1="469.0234" y2="469.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="366" y="463.9575">Boolean</text><path d="M23,484.0234 L95,484.0234 L95,491.0234 L85,501.0234 L23,501.0234 L23,484.0234 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="381" x="23" y="484.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="38" y="497.0903">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="110" y="496.2339">[!isNeededUpdatePhotos]</text><polygon fill="#A80036" points="70,518.2891,60,522.2891,70,526.2891,66,522.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="338" y1="522.2891" y2="522.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="517.2231">Callback#requestUpdatePhotosResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="349" x2="396" y1="531.2891" y2="531.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="396" x2="396" y1="531.2891" y2="544.2891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="396" y1="544.2891" y2="544.2891"/><polygon fill="#A80036" points="365,540.2891,355,544.2891,365,548.2891,361,544.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="335" x2="353" y1="570.2891" y2="588.2891"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="335" x2="353" y1="588.2891" y2="570.2891"/><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1537.5" x="3" y="614.8555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="614.8555" y2="614.8555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="617.8555" y2="617.8555"/><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="190" x="676.75" y="604.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="682.75" y="620.356">Decide Selected Album</text><polygon fill="#A80036" points="622,654.5547,632,658.5547,622,662.5547,626,658.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="349" x2="628" y1="658.5547" y2="658.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="356" y="653.4888">hasSelectedAlbums</text><polygon fill="#A80036" points="360,683.6875,350,687.6875,360,691.6875,356,687.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="354" x2="638" y1="687.6875" y2="687.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="366" y="682.6216">Boolean</text><path d="M13,702.6875 L85,702.6875 L85,709.6875 L75,719.6875 L13,719.6875 L13,702.6875 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="206.6641" style="stroke: #000000; stroke-width: 2.0;" width="1085.5" x="13" y="702.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="28" y="715.7544">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145" x="100" y="714.8979">[!hasSelectedAlbums]</text><polygon fill="#A80036" points="1043,736.9531,1053,740.9531,1043,744.9531,1047,740.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="349" x2="1049" y1="740.9531" y2="740.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="356" y="735.8872">startSelectActivity</text><polygon fill="#A80036" points="47,750.9531,57,754.9531,47,758.9531,51,754.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="3" x2="53" y1="754.9531" y2="754.9531"/><polygon fill="#A80036" points="327,780.0859,337,784.0859,327,788.0859,331,784.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="59" x2="333" y1="784.0859" y2="784.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="66" y="779.02">evaluateActivityResult</text><path d="M23,799.0859 L95,799.0859 L95,806.0859 L85,816.0859 L23,816.0859 L23,799.0859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="381" x="23" y="799.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="38" y="812.1528">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="286" x="110" y="811.2964">[Is selected album not found or canceled?]</text><polygon fill="#A80036" points="70,833.3516,60,837.3516,70,841.3516,66,837.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="338" y1="837.3516" y2="837.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="832.2856">Callback#requestUpdatePhotosResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="349" x2="396" y1="846.3516" y2="846.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="396" x2="396" y1="846.3516" y2="859.3516"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="355" x2="396" y1="859.3516" y2="859.3516"/><polygon fill="#A80036" points="365,855.3516,355,859.3516,365,863.3516,361,859.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="335" x2="353" y1="885.3516" y2="903.3516"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="335" x2="353" y1="903.3516" y2="885.3516"/><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1537.5" x="3" y="936.918"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="936.918" y2="936.918"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="939.918" y2="939.918"/><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="152" x="695.75" y="926.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="701.75" y="942.4185">Download Images</text><polygon fill="#A80036" points="622,976.6172,632,980.6172,622,984.6172,626,980.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="349" x2="628" y1="980.6172" y2="980.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="356" y="975.5513">requestDownloadPhotos</text><path d="M573.5,995.6172 L651.5,995.6172 L651.5,1002.6172 L641.5,1012.6172 L573.5,1012.6172 L573.5,995.6172 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="278.1953" style="stroke: #000000; stroke-width: 2.0;" width="957" x="573.5" y="995.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="33" x="588.5" y="1008.6841">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="114" x="666.5" y="1007.8276">[albums.foreach]</text><polygon fill="#A80036" points="1437,1029.8828,1447,1033.8828,1437,1037.8828,1441,1033.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="1443" y1="1033.8828" y2="1033.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="651" y="1028.8169">requestMediaItems</text><polygon fill="#A80036" points="655,1059.0156,645,1063.0156,655,1067.0156,651,1063.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="649" x2="1453" y1="1063.0156" y2="1063.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="661" y="1057.9497">PhotosApiResult&lt;MediaItem&gt;</text><path d="M583.5,1078.0156 L655.5,1078.0156 L655.5,1085.0156 L645.5,1095.0156 L583.5,1095.0156 L583.5,1078.0156 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="641" x="583.5" y="1078.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="598.5" y="1091.0825">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="202" x="670.5" y="1090.2261">[Is result.tokenInfo updated?]</text><polygon fill="#A80036" points="1144.5,1112.2813,1154.5,1116.2813,1144.5,1120.2813,1148.5,1116.2813" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="1150.5" y1="1116.2813" y2="1116.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="651" y="1111.2153">updateUserInfo</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="686" y1="1152.4141" y2="1152.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="686" x2="686" y1="1152.4141" y2="1165.4141"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645" x2="686" y1="1165.4141" y2="1165.4141"/><polygon fill="#A80036" points="655,1161.4141,645,1165.4141,655,1169.4141,651,1165.4141" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="209" x="651" y="1147.3481">Make random photo MediaItems.</text><polygon fill="#A80036" points="1284,1190.5469,1294,1194.5469,1284,1198.5469,1288,1194.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="1290" y1="1194.5469" y2="1194.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="651" y="1189.481">requestDownloads</text><polygon fill="#A80036" points="655,1219.6797,645,1223.6797,655,1227.6797,651,1223.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="649" x2="1300" y1="1223.6797" y2="1223.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="661" y="1218.6138">List&lt;String&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="686" y1="1252.8125" y2="1252.8125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="686" x2="686" y1="1252.8125" y2="1265.8125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="645" x2="686" y1="1265.8125" y2="1265.8125"/><polygon fill="#A80036" points="655,1261.8125,645,1265.8125,655,1269.8125,651,1265.8125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="219" x="651" y="1247.7466">Geneate PhotoInfo and add to list.</text><polygon fill="#A80036" points="360,1297.9453,350,1301.9453,360,1305.9453,356,1301.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="354" x2="638" y1="1301.9453" y2="1301.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="261" x="366" y="1296.8794">Callback#requestDownloadPhotosResult</text><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1537.5" x="3" y="1330.5117"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="1330.5117" y2="1330.5117"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="1333.5117" y2="1333.5117"/><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="150" x="696.75" y="1319.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="131" x="702.75" y="1336.0122">Update Database</text><polygon fill="#A80036" points="622,1370.2109,632,1374.2109,622,1378.2109,626,1374.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="349" x2="628" y1="1374.2109" y2="1374.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="356" y="1369.145">requestUpdateDatabase</text><polygon fill="#A80036" points="1144.5,1399.3438,1154.5,1403.3438,1144.5,1407.3438,1148.5,1403.3438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="1150.5" y1="1403.3438" y2="1403.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="651" y="1398.2778">replaceSelectedData</text><polygon fill="#A80036" points="1139.5,1428.4766,1149.5,1432.4766,1139.5,1436.4766,1143.5,1432.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="644" x2="1145.5" y1="1432.4766" y2="1432.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="651" y="1427.4106">findUserInfoDataById</text><polygon fill="#A80036" points="655,1457.6094,645,1461.6094,655,1465.6094,651,1461.6094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="649" x2="1155.5" y1="1461.6094" y2="1461.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="661" y="1456.5435">UserInfoData?</text><polygon fill="#A80036" points="360,1486.7422,350,1490.7422,360,1494.7422,356,1490.7422" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="354" x2="638" y1="1490.7422" y2="1490.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="261" x="366" y="1485.6763">Callback#requestUpdateDatabaseResult</text><rect fill="#EEEEEE" filter="url(#f5lxp6rl0pyr4)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1537.5" x="3" y="1511.7422"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="1511.7422" y2="1511.7422"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1540.5" y1="1514.7422" y2="1514.7422"/><polygon fill="#A80036" points="70,1543.875,60,1547.875,70,1551.875,66,1547.875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="64" x2="343" y1="1547.875" y2="1547.875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="76" y="1542.8091">Callback#requestUpdatePhotosResult</text><!--MD5=[81a818acdface510d662edc2f0d6a5b5]
@startuml
box "VIPER" #FFFFEE
  participant View
  participant Presenter
  participant Interactor
  participant Router
end box

box "Database" #FFEEFF
  participant AppDatabase
end box

box "File" #E6FFE9
  participant PhotosDownloader
end box

box "Web API" #EEFFFF
  participant GoogleWebApis
end box

View++
View -> Presenter++: requestLoadDisplayedPhotos
  Presenter -> Interactor++: requestLoadDisplayedPhotos

  opt this.userInfoData.id == 0
    Interactor -> AppDatabase++: findUserInfoDataByEmailAddress
    return UserInfoData?
  end

  Interactor -> Interactor: Get DisplayedPhotos from UserInfoData.dataList and shuffle.
  return Callback#requestLoadDisplayedPhotos
return Callback#requestLoadDisplayedPhotos

View -> Presenter++: requestUpdateDisplayedPhotos
View- -

== Config Update ==

Presenter -> Interactor++: isNeededUpdatePhotos
return Boolean

opt !isNeededUpdatePhotos
  View <- - Presenter: Callback#requestUpdatePhotosResult
  Presenter -> Presenter++
  destroy Presenter
end

== Decide Selected Album ==

Presenter -> Interactor++: hasSelectedAlbums
return Boolean

opt !hasSelectedAlbums
  Presenter -> Router: startSelectActivity
  [- -> View
  View - -> Presenter: evaluateActivityResult

  opt Is selected album not found or canceled?
    View <- - Presenter: Callback#requestUpdatePhotosResult
    Presenter -> Presenter++
    destroy Presenter
  end
end

== Download Images ==

Presenter -> Interactor++: requestDownloadPhotos

  loop albums.foreach
    Interactor -> GoogleWebApis++: requestMediaItems
    return PhotosApiResult<MediaItem>

    opt Is result.tokenInfo updated?
      Interactor -> AppDatabase: updateUserInfo
    end

    Interactor -> Interactor: Make random photo MediaItems.

    Interactor -> PhotosDownloader++: requestDownloads
    return List<String>

    Interactor -> Interactor: Geneate PhotoInfo and add to list.
  end

return Callback#requestDownloadPhotosResult

== Update Database ==

Presenter -> Interactor++: requestUpdateDatabase
  Interactor -> AppDatabase: replaceSelectedData
  Interactor -> AppDatabase++: findUserInfoDataById
  return UserInfoData?
return Callback#requestUpdateDatabaseResult

====

View <- - Presenter- -: Callback#requestUpdatePhotosResult
@enduml

PlantUML version 1.2020.16beta7(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>