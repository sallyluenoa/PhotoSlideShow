<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1544px" preserveAspectRatio="none" style="width:2058px;height:1544px;" version="1.1" viewBox="0 0 2058 1544" width="2058px" zoomAndPan="magnify"><defs><filter height="300%" id="f1otrz0a3y8pid" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFEE" height="1529.7734" style="stroke: #A80036; stroke-width: 1.0;" width="805.5" x="19" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="399.75" y="16.0669">VIPER</text><rect fill="#EEFFFF" height="1529.7734" style="stroke: #A80036; stroke-width: 1.0;" width="453" x="826.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1022" y="16.0669">Web API</text><rect fill="#FFEEFF" height="1529.7734" style="stroke: #A80036; stroke-width: 1.0;" width="601" x="1281.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="72" x="1546" y="16.0669">Database</text><rect fill="#E6FFE9" height="1529.7734" style="stroke: #A80036; stroke-width: 1.0;" width="161" x="1884.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="1952" y="16.0669">File</text><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="51.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="44" y="68.4297"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="1387.9141" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="236" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="241" y="282.2266"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="241" y="612.4219"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="241" y="1082.1484"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="148.6953"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="396.4922"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="233.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="478.8906"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="791.9531"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="1029.0156"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="216.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="1203.4141"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1045.5" y="508.0234"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1199.5" y="1232.5469"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1353" y="177.8281"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1533.5" y="821.0859"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1960" y="1332.9453"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="74.1328" style="stroke: #000000; stroke-width: 2.0;" width="265" x="186.5" y="251.0938"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="280.0625" style="stroke: #000000; stroke-width: 2.0;" width="1264" x="176.5" y="440.625"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="427" x="186.5" y="552.1563"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="237.7969" style="stroke: #000000; stroke-width: 2.0;" width="1643.5" x="13" y="894.3516"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="134.3984" style="stroke: #000000; stroke-width: 2.0;" width="1460" x="186.5" y="990.75"/><rect fill="#FFFFFF" height="59" style="stroke: none; stroke-width: 1.0;" width="1460" x="186.5" y="1066.1484"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="49" x2="49" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="240.5" x2="240.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="557.5" x2="557.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="786.5" x2="786.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="898.5" x2="898.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1050.5" x2="1050.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1204.5" x2="1204.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1357.5" x2="1357.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1538.5" x2="1538.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1762.5" x2="1762.5" y1="58.4297" y2="1495.4766"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1964.5" x2="1964.5" y1="58.4297" y2="1495.4766"/><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="23" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="30" y="43.1279">View</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="48" x="23" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="30" y="1514.4717">View</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="196.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="203.5" y="43.1279">Presenter</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="196.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="203.5" y="1514.4717">Presenter</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="512.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="519.5" y="43.1279">Interactor</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="87" x="512.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="519.5" y="1514.4717">Interactor</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="753.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="760.5" y="43.1279">Router</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="63" x="753.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="760.5" y="1514.4717">Router</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="830.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="837.5" y="43.1279">GoogleSignInApi</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="133" x="830.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="119" x="837.5" y="1514.4717">GoogleSignInApi</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="977.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="984.5" y="43.1279">GoogleOAuth2Api</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="142" x="977.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="128" x="984.5" y="1514.4717">GoogleOAuth2Api</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1133.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1140.5" y="43.1279">PhotosLibraryApi</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="1133.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="124" x="1140.5" y="1514.4717">PhotosLibraryApi</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="1285.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="1292.5" y="43.1279">UserInfoDatabase</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="141" x="1285.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="127" x="1292.5" y="1514.4717">UserInfoDatabase</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="192" x="1440.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="178" x="1447.5" y="43.1279">SelectedAlbumDatabase</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="192" x="1440.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="178" x="1447.5" y="1514.4717">SelectedAlbumDatabase</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="228" x="1646.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="214" x="1653.5" y="43.1279">DisplayedMediaItemDatabase</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="228" x="1646.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="214" x="1653.5" y="1514.4717">DisplayedMediaItemDatabase</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1888.5" y="23.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1895.5" y="43.1279">PhotosDownloader</text><rect fill="#FEFECE" filter="url(#f1otrz0a3y8pid)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="1888.5" y="1494.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="135" x="1895.5" y="1514.4717">PhotosDownloader</text><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="51.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="44" y="68.4297"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="1387.9141" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="236" y="89.5625"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="241" y="282.2266"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="241" y="612.4219"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="28" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="241" y="1082.1484"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="148.6953"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="396.4922"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="233.7969" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="478.8906"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="87.3984" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="791.9531"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="1029.0156"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="216.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="553" y="1203.4141"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1045.5" y="508.0234"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1199.5" y="1232.5469"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1353" y="177.8281"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1533.5" y="821.0859"/><rect fill="#FFFFFF" filter="url(#f1otrz0a3y8pid)" height="29.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="1960" y="1332.9453"/><polygon fill="#A80036" points="224,85.5625,234,89.5625,224,93.5625,228,89.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="54" x2="230" y1="89.5625" y2="89.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="61" y="84.4966">requestUpdatePhotoData</text><polygon fill="#A80036" points="541,144.6953,551,148.6953,541,152.6953,545,148.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="547" y1="148.6953" y2="148.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="253" y="143.6294">isNeededPhotosUpdate</text><polygon fill="#A80036" points="1341,173.8281,1351,177.8281,1341,181.8281,1345,177.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="1347" y1="177.8281" y2="177.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="570" y="172.7622">find</text><polygon fill="#A80036" points="574,202.9609,564,206.9609,574,210.9609,570,206.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="568" x2="1357" y1="206.9609" y2="206.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="53" x="580" y="201.895">UserInfo</text><polygon fill="#A80036" points="257,232.0938,247,236.0938,257,240.0938,253,236.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="251" x2="557" y1="236.0938" y2="236.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="263" y="231.0278">Boolean</text><path d="M186.5,251.0938 L258.5,251.0938 L258.5,258.0938 L248.5,268.0938 L186.5,268.0938 L186.5,251.0938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="74.1328" style="stroke: #000000; stroke-width: 2.0;" width="265" x="186.5" y="251.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="201.5" y="264.1606">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="273.5" y="263.3042">[!isNeededPhotosUpdate]</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="293" y1="269.2266" y2="269.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="293" x2="293" y1="269.2266" y2="282.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="293" y1="282.2266" y2="282.2266"/><polygon fill="#A80036" points="262,278.2266,252,282.2266,262,286.2266,258,282.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="232" x2="250" y1="308.2266" y2="326.2266"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="232" x2="250" y1="326.2266" y2="308.2266"/><rect fill="#EEEEEE" filter="url(#f1otrz0a3y8pid)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2043.5" x="3" y="352.793"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2046.5" y1="352.793" y2="352.793"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2046.5" y1="355.793" y2="355.793"/><rect fill="#EEEEEE" filter="url(#f1otrz0a3y8pid)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="177" x="936.25" y="342.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="942.25" y="358.2935">Update AccessToken</text><polygon fill="#A80036" points="541,392.4922,551,396.4922,541,400.4922,545,396.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="547" y1="396.4922" y2="396.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="253" y="391.4263">isNeededUpdateAccessToken</text><polygon fill="#A80036" points="257,421.625,247,425.625,257,429.625,253,425.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="251" x2="557" y1="425.625" y2="425.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="263" y="420.5591">Boolean</text><path d="M176.5,440.625 L248.5,440.625 L248.5,447.625 L238.5,457.625 L176.5,457.625 L176.5,440.625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="280.0625" style="stroke: #000000; stroke-width: 2.0;" width="1264" x="176.5" y="440.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="191.5" y="453.6919">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="210" x="263.5" y="452.8354">[!isNeededUpdateAccessToken]</text><polygon fill="#A80036" points="541,474.8906,551,478.8906,541,482.8906,545,478.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="547" y1="478.8906" y2="478.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="253" y="473.8247">requestUpdateAccessToken</text><polygon fill="#A80036" points="1033.5,504.0234,1043.5,508.0234,1033.5,512.0234,1037.5,508.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="1039.5" y1="508.0234" y2="508.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="570" y="502.9575">requestTokenInfoWithRefreshToken</text><polygon fill="#A80036" points="574,533.1563,564,537.1563,574,541.1563,570,537.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="568" x2="1049.5" y1="537.1563" y2="537.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="580" y="532.0903">TokenInfo</text><path d="M186.5,552.1563 L258.5,552.1563 L258.5,559.1563 L248.5,569.1563 L186.5,569.1563 L186.5,552.1563 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="103.2656" style="stroke: #000000; stroke-width: 2.0;" width="427" x="186.5" y="552.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="201.5" y="565.2231">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="121" x="273.5" y="564.3667">[TokenInfo==null]</text><polygon fill="#A80036" points="257,586.4219,247,590.4219,257,594.4219,253,590.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="251" x2="552" y1="590.4219" y2="590.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="263" y="585.356">Callback#requestUpdateAccessTokenResult</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="293" y1="599.4219" y2="599.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="293" x2="293" y1="599.4219" y2="612.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="293" y1="612.4219" y2="612.4219"/><polygon fill="#A80036" points="262,608.4219,252,612.4219,262,616.4219,258,612.4219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="232" x2="250" y1="638.4219" y2="656.4219"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="232" x2="250" y1="656.4219" y2="638.4219"/><polygon fill="#A80036" points="1346,679.5547,1356,683.5547,1346,687.5547,1350,683.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="1352" y1="683.5547" y2="683.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="570" y="678.4888">update</text><polygon fill="#A80036" points="257,708.6875,247,712.6875,257,716.6875,253,712.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="251" x2="557" y1="712.6875" y2="712.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="283" x="263" y="707.6216">Callback#requestUpdateAccessTokenResult</text><rect fill="#EEEEEE" filter="url(#f1otrz0a3y8pid)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2043.5" x="3" y="748.2539"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2046.5" y1="748.2539" y2="748.2539"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2046.5" y1="751.2539" y2="751.2539"/><rect fill="#EEEEEE" filter="url(#f1otrz0a3y8pid)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="190" x="929.75" y="737.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="935.75" y="753.7544">Decide Selected Album</text><polygon fill="#A80036" points="541,787.9531,551,791.9531,541,795.9531,545,791.9531" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="547" y1="791.9531" y2="791.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="253" y="786.8872">hasSelectedAlbum</text><polygon fill="#A80036" points="1521.5,817.0859,1531.5,821.0859,1521.5,825.0859,1525.5,821.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="1527.5" y1="821.0859" y2="821.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="570" y="816.02">find</text><polygon fill="#A80036" points="574,846.2188,564,850.2188,574,854.2188,570,850.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="568" x2="1537.5" y1="850.2188" y2="850.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="580" y="845.1528">SelectedAlbum</text><polygon fill="#A80036" points="257,875.3516,247,879.3516,257,883.3516,253,879.3516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="251" x2="557" y1="879.3516" y2="879.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="51" x="263" y="874.2856">Boolean</text><path d="M13,894.3516 L85,894.3516 L85,901.3516 L75,911.3516 L13,911.3516 L13,894.3516 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="237.7969" style="stroke: #000000; stroke-width: 2.0;" width="1643.5" x="13" y="894.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="27" x="28" y="907.4185">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="138" x="100" y="906.562">[!hasSelectedAlbum]</text><polygon fill="#A80036" points="775,928.6172,785,932.6172,775,936.6172,779,932.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="781" y1="932.6172" y2="932.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="253" y="927.5513">startSelectActivity</text><polygon fill="#A80036" points="37,942.6172,47,946.6172,37,950.6172,41,946.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="3" x2="43" y1="946.6172" y2="946.6172"/><polygon fill="#A80036" points="224,971.75,234,975.75,224,979.75,228,975.75" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="49" x2="230" y1="975.75" y2="975.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="56" y="970.6841">evaluateActivityResult</text><path d="M186.5,990.75 L252.5,990.75 L252.5,997.75 L242.5,1007.75 L186.5,1007.75 L186.5,990.75 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="134.3984" style="stroke: #000000; stroke-width: 2.0;" width="1460" x="186.5" y="990.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="201.5" y="1003.8169">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="158" x="267.5" y="1002.9604">[Has selected albumId?]</text><polygon fill="#A80036" points="541,1025.0156,551,1029.0156,541,1033.0156,545,1029.0156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="547" y1="1029.0156" y2="1029.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="253" y="1023.9497">updateSelectedAlbumInfo</text><polygon fill="#A80036" points="1526.5,1054.1484,1536.5,1058.1484,1526.5,1062.1484,1530.5,1058.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="558" x2="1532.5" y1="1058.1484" y2="1058.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="45" x="565" y="1053.0825">update</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="186.5" x2="1646.5" y1="1067.1484" y2="1067.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="293" y1="1069.1484" y2="1069.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="293" x2="293" y1="1069.1484" y2="1082.1484"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="293" y1="1082.1484" y2="1082.1484"/><polygon fill="#A80036" points="262,1078.1484,252,1082.1484,262,1086.1484,258,1082.1484" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="232" x2="250" y1="1108.1484" y2="1126.1484"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="232" x2="250" y1="1126.1484" y2="1108.1484"/><rect fill="#EEEEEE" filter="url(#f1otrz0a3y8pid)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2043.5" x="3" y="1159.7148"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2046.5" y1="1159.7148" y2="1159.7148"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2046.5" y1="1162.7148" y2="1162.7148"/><rect fill="#EEEEEE" filter="url(#f1otrz0a3y8pid)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="152" x="948.75" y="1149.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="133" x="954.75" y="1165.2153">Download Images</text><polygon fill="#A80036" points="541,1199.4141,551,1203.4141,541,1207.4141,545,1203.4141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246" x2="547" y1="1203.4141" y2="1203.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="253" y="1198.3481">requestDownloadMediaItems</text><polygon fill="#A80036" points="1187.5,1228.5469,1197.5,1232.5469,1187.5,1236.5469,1191.5,1232.5469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="1193.5" y1="1232.5469" y2="1232.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="570" y="1227.481">requestMediaItems</text><polygon fill="#A80036" points="574,1257.6797,564,1261.6797,574,1265.6797,570,1261.6797" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="568" x2="1203.5" y1="1261.6797" y2="1261.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="580" y="1256.6138">List&lt;MediaItem&gt;</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="605" y1="1290.8125" y2="1290.8125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="605" x2="605" y1="1290.8125" y2="1303.8125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="564" x2="605" y1="1303.8125" y2="1303.8125"/><polygon fill="#A80036" points="574,1299.8125,564,1303.8125,574,1307.8125,570,1303.8125" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="570" y="1285.7466">Make random photo MediaItems</text><polygon fill="#A80036" points="1948,1328.9453,1958,1332.9453,1948,1336.9453,1952,1332.9453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="1954" y1="1332.9453" y2="1332.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="570" y="1327.8794">requestDownloads</text><polygon fill="#A80036" points="574,1358.0781,564,1362.0781,574,1366.0781,570,1362.0781" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="568" x2="1964" y1="1362.0781" y2="1362.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="79" x="580" y="1357.0122">List&lt;String&gt;</text><polygon fill="#A80036" points="1750.5,1387.2109,1760.5,1391.2109,1750.5,1395.2109,1754.5,1391.2109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="563" x2="1756.5" y1="1391.2109" y2="1391.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="570" y="1386.145">replace</text><polygon fill="#A80036" points="257,1416.3438,247,1420.3438,257,1424.3438,253,1420.3438" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="251" x2="557" y1="1420.3438" y2="1420.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="226" x="263" y="1415.2778">requestDownloadMediaItemsResult</text><rect fill="#EEEEEE" filter="url(#f1otrz0a3y8pid)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2043.5" x="3" y="1441.3438"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2046.5" y1="1441.3438" y2="1441.3438"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="2046.5" y1="1444.3438" y2="1444.3438"/><polygon fill="#A80036" points="60,1473.4766,50,1477.4766,60,1481.4766,56,1477.4766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="54" x2="240" y1="1477.4766" y2="1477.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="66" y="1472.4106">notifyUpdatedPhotoData</text><!--MD5=[eb777c23d8c0250d436ff1e91360d357]
@startuml
box "VIPER" #FFFFEE
  participant View
  participant Presenter
  participant Interactor
  participant Router
end box

box "Web API" #EEFFFF
  participant GoogleSignInApi
  participant GoogleOAuth2Api
  participant PhotosLibraryApi
end box

box "Database" #FFEEFF
  participant UserInfoDatabase
  participant SelectedAlbumDatabase
  participant DisplayedMediaItemDatabase
end box

box "File" #E6FFE9
  participant PhotosDownloader
end box

View++
View -> Presenter++: requestUpdatePhotoData
View- -

Presenter -> Interactor++: isNeededPhotosUpdate
  Interactor -> UserInfoDatabase++: find
  return UserInfo
return Boolean

opt !isNeededPhotosUpdate
  Presenter -> Presenter++
  destroy Presenter
end

== Update AccessToken ==

Presenter -> Interactor++: isNeededUpdateAccessToken
return Boolean

opt !isNeededUpdateAccessToken
  Presenter -> Interactor++: requestUpdateAccessToken
  Interactor -> GoogleOAuth2Api++: requestTokenInfoWithRefreshToken
  return TokenInfo

  opt TokenInfo==null
    Presenter <- - Interactor: Callback#requestUpdateAccessTokenResult
    Presenter -> Presenter++
    destroy Presenter
  end

  Interactor -> UserInfoDatabase: update
  Presenter <- - Interactor- -: Callback#requestUpdateAccessTokenResult
end

== Decide Selected Album ==

Presenter -> Interactor++: hasSelectedAlbum
  Interactor -> SelectedAlbumDatabase++: find
  return SelectedAlbum
return Boolean

opt !hasSelectedAlbum
  Presenter -> Router: startSelectActivity
  [- -> View
  View - -> Presenter: evaluateActivityResult

  alt Has selected albumId?
    Presenter -> Interactor++: updateSelectedAlbumInfo
    Interactor -> SelectedAlbumDatabase: update
    Interactor- -
  else
    Presenter -> Presenter++
    destroy Presenter
  end
end

== Download Images ==

Presenter -> Interactor++: requestDownloadMediaItems

  Interactor -> PhotosLibraryApi++: requestMediaItems
  return List<MediaItem>

  Interactor -> Interactor: Make random photo MediaItems

  Interactor -> PhotosDownloader++: requestDownloads
  return List<String>

  Interactor -> DisplayedMediaItemDatabase: replace

Presenter <- - Interactor- -: requestDownloadMediaItemsResult

====

View <- - Presenter- -: notifyUpdatedPhotoData
@enduml

PlantUML version 1.2020.15beta1(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>